<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>DarkDog Browser</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #0b0b0b;
      color: white;
    }

    .tab-bar {
      display: flex;
      align-items: center;
      background: #111;
      padding: 6px;
      border-bottom: 2px solid red;
    }

    .tab {
      display: flex;
      align-items: center;
      background: #222;
      border: 1px solid red;
      padding: 6px 10px;
      margin-right: 6px;
      color: red;
      border-radius: 6px 6px 0 0;
      cursor: pointer;
      font-weight: bold;
    }

    .tab.active {
      background: #000;
      color: white;
      border-bottom: none;
    }

    .tab .close {
      margin-left: 8px;
      color: red;
      background: transparent;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }

    .new-tab {
      background: #222;
      color: red;
      padding: 6px 12px;
      border: 2px dashed red;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    .top-bar {
      display: flex;
      align-items: center;
      background-color: #1a1a1a;
      padding: 8px;
      position: relative;
    }

    .button {
      background: #2a2a2a;
      color: #ff0000;
      border: none;
      padding: 6px 10px;
      margin-right: 6px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    .address-bar {
      flex-grow: 1;
      padding: 8px;
      background: #222;
      border: 1px solid red;
      border-radius: 6px;
      color: white;
    }

    .menu-button {
      font-size: 20px;
      padding: 4px 8px;
      background: #222;
      border: 1px solid red;
      border-radius: 6px;
      color: red;
      margin-left: 6px;
    }

    .menu-dropdown {
      position: absolute;
      right: 16px;
      top: 56px;
      background: #111;
      border: 1px solid red;
      border-radius: 6px;
      color: white;
      min-width: 140px;
      z-index: 999;
      display: flex;
      flex-direction: column;
    }

    .menu-item {
      padding: 8px 12px;
      cursor: pointer;
      border-bottom: 1px solid #333;
    }

    .menu-item:last-child {
      border-bottom: none;
    }

    .menu-item:hover {
      background: #222;
    }

    .hidden {
      display: none;
    }

    iframe {
      width: 100%;
      height: calc(100vh - 96px);
      border: none;
      background: #1c1c1c;
    }
  </style>
</head>
<body>
  <div class="tab-bar" id="tabBar">
    <button class="new-tab" id="addTab">+</button>
  </div>

  <div class="top-bar">
    <button class="button" id="backBtn">◀</button>
    <button class="button" id="forwardBtn">▶</button>
    <button class="button" id="reloadBtn">⟳</button>
    <button class="button" id="homeBtn">Home</button>
    <input class="address-bar" id="addressBar" placeholder="Search or enter URL…" />
    <button class="menu-button" id="menuButton">⋮</button>
    <div id="menuDropdown" class="menu-dropdown hidden">
      <div class="menu-item">New Tab</div>
      <div class="menu-item">Bookmarks</div>
      <div class="menu-item">Settings</div>
    </div>
  </div>

  <iframe id="browserFrame"></iframe>

  <script>
    const tabBar = document.getElementById("tabBar");
    const addressBar = document.getElementById("addressBar");
    const frame = document.getElementById("browserFrame");
    const addTabBtn = document.getElementById("addTab");
    const backBtn = document.getElementById("backBtn");
    const forwardBtn = document.getElementById("forwardBtn");
    const reloadBtn = document.getElementById("reloadBtn");
    const homeBtn = document.getElementById("homeBtn");
    const menuBtn = document.getElementById("menuButton");
    const dropdown = document.getElementById("menuDropdown");

    let tabs = [];
    let activeTabIndex = -1;

    function createTab(url = "") {
      const tabIndex = tabs.length;
      tabs.push({ url, history: [url], index: 0 });

      const tab = document.createElement("div");
      tab.className = "tab";
      tab.innerHTML = `<span>${url || "New Tab"}</span><button class="close">×</button>`;
      tabBar.insertBefore(tab, addTabBtn);

      tab.onclick = () => switchTab(tabIndex);
      tab.querySelector(".close").onclick = (e) => {
        e.stopPropagation();
        removeTab(tabIndex);
      };

      switchTab(tabIndex);
    }

    function switchTab(i) {
      document.querySelectorAll(".tab").forEach((tab, idx) => {
        tab.classList.toggle("active", idx === i);
        tab.querySelector("span").textContent = tabs[idx].url || "New Tab";
      });

      activeTabIndex = i;
      const tabData = tabs[i];
      addressBar.value = tabData.url;
      frame.src = tabData.url;
    }

    function isValidUrl(str) {
      return str.startsWith("http://") || str.startsWith("https://");
    }

    function navigate(input) {
      const trimmed = input.trim();
      const target = isValidUrl(trimmed)
        ? trimmed
        : "https://duckduckgo.com/?q=" + encodeURIComponent(trimmed);

      const tab = tabs[activeTabIndex];
      tab.history = tab.history.slice(0, tab.index + 1);
      tab.history.push(target);
      tab.index++;
      tab.url = target;

      switchTab(activeTabIndex);
    }

    function removeTab(i) {
      tabs.splice(i, 1);
      tabBar.removeChild(tabBar.children[i]);
      if (tabs.length === 0) {
        frame.src = "";
        addressBar.value = "";
        activeTabIndex = -1;
      } else {
        switchTab(Math.max(0, i - 1));
      }
    }

    addressBar.addEventListener("keypress", e => {
      if (e.key === "Enter") navigate(addressBar.value);
    });

    backBtn.addEventListener("click", () => {
      const tab = tabs[activeTabIndex];
      if (tab.index > 0) {
        tab.index--;
        tab.url = tab.history[tab.index];
        switchTab(activeTabIndex);
      }
    });

    forwardBtn.addEventListener("click", () => {
      const tab = tabs[activeTabIndex];
      if (tab.index < tab.history.length - 1) {
        tab.index++;
        tab.url = tab.history[tab.index];
        switchTab(activeTabIndex);
      }
    });

    reloadBtn.addEventListener("click", () => {
      frame.src = tabs[activeTabIndex].url;
    });

    homeBtn.addEventListener("click", () => {
      navigate("https://duckduckgo.com");
    });

    addTabBtn.addEventListener("click", () => createTab());

    menuBtn.onclick = () => {
      dropdown.classList.toggle("hidden");
    };

    document.addEventListener("click", e => {
      if (!menuBtn.contains(e.target) && !dropdown.contains(e.target)) {
        dropdown.classList.add("hidden");
      }
    });

    dropdown.querySelectorAll(".menu-item").forEach(item => {
      item.onclick = () => {
        const text = item.textContent;
        if (text === "New Tab") createTab();
        else alert(`${text} clicked`);
        dropdown.classList.add("hidden");
      };
    });

    createTab();
  </script>
</body>
</html>
